# 性能测试（Benchmark）

本页展示 HighPerformance-KVStore 的压测方法与性能结果。

---

## 🖥️ 测试环境

- 系统：Ubuntu 20.04（WSL2）
- CPU：本机（如 4 核 / 8 线程）
- 内存：8GB+
- 网络：本地回环 `127.0.0.1`
- 工具：自研多线程压测客户端 `benchmark.cpp`

---

## 🔧 压测场景

- 并发线程：50
- 请求模式：读写 1:1 混合
- 连接模式：长连接
- 总请求数：100,000（示例）

压测流程：

1. 每个线程建立一个连接  
2. 循环执行：`SET` → `GET`  
3. 记录总耗时  
4. 计算 QPS（每秒处理请求数）

---

## 📈 压测结果示例

成功请求数: 100000
总耗时: 2.842 秒
QPS: 35186.5 次/秒

yaml
复制代码

说明：

- 本机单线程 Reactor + Epoll ET  
- QPS 可达到约 **3.5 万**  
- 在学习项目里属于非常优秀的性能指标

---

## 📉 性能影响因素

- 是否开启 g++ 优化（`-O2` / `-O3`）
- 是否关闭 Nagle（TCP_NODELAY）
- 单线程 CPU 是否达到 100%
- map/unordered_map 数据结构差异
- 系统调用频率（read/write 次数）
- 持久化是否阻塞主线程

---

## 🚀 可进一步优化的方向

- 引入线程池处理读写事件
- KVStore 换成 `unordered_map`
- 引入 pipeline 批处理减少 RTT
- 引入异步持久化（后台线程写快照）
- 减少内存拷贝与系统调用